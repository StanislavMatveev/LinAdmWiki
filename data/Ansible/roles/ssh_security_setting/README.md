# Роль ssh_security_setting

## Описание

Данная роль настраивает SSH-сервер, с целью повышения безопасности. Роль меняет файл sshd в соответствии с параметрами из переменной `options`. Далее проходит проверка примененных параметров, если возникает ошибка, происходит откат к изначальным настройкам путем восстановления файла sshd. Если же проверка проходит успешно, происходит перезагрузка сервиса sshd и применение настроек.
Если использовалась переменная `changed_port`, проверятся работоспосбность сервера на этом порту и если после проверки не возникло ошибок, то настроенный сервер доступен на новом порту (или на дефолтном, если переменная не указывалась).

## Переменные

*Переменные в каталоге defaults данной роли:*

- `options` - рекомендуемые опции для повышения безопасности сервера.

*Переменные которые необходимо указать в файлах group_vars:*

- `ansible_port` - стандартный порт ssh, на котором в данный момент работает сервер. Необходимо указывать для корректной работы. Если есть группа серверов с разными портами необходимо указывать данную переменную в host_vars.
```
ansible_port: 22
```

- `changed_port` - опциональная переменная, если необходимо изменить порт. Если не использовать, значение порта будет настроенно для переменной `ansible_port`.
```
changed_port: 8882
```

- `users_with_access` - переменная содержащая имена пользователей, которым необходимо предоставить доступ по ssh.
```
users_with_access:
  - root
  - test
```

