# Роль promtail_install

## Описание

Данная роль устанавливает promtail версии 3.2.0. Установка происходит, за счет копирования бинарного файла и необходимых конфигов, это необходимо учитывать! Роль добавляет в систему группу и пользователя указанных в соответствующих переменных.
Так же, в данной роли, можно опционально включить tls шифрование.

Список файлов, необходимых для корректной работы:
- ca.crt - сертификат доверия, если используется tls (опционально).
- promtail - бинарный файл promtail.

Список шаблонов, необходимых для корректной работы:
- config_with_tls.yml.j2 - конфиг promtail с tls шифрованием (опционально).
- config_without_tls.yml.j2 - конфиг promtail без tls шифрования.
- promtail.service.j2 - файл юнита для systemd.

**Внимание!** Для корректной работы необходимо сохранить названия файлов.

## Переменные

*Переменные в каталоге defaults данной роли:*

- `tls_ciph` - переменная для указания необходимости использования tls шифрования, по умолчанию `false`. Если необходимо включить tls, то данную переменную необходимо переопределить через group_vars в значение `true`, а также добавить файл `ca.crt` в папку files данной роли.

- `loki_server` - IP адрес loki сервера, по умолчанию `localhost`. Необходимо переопредилить через group_vars.

- `loki_port` - порт loki для доступа к серверу, по умолчанию `3100`. Если используется не стандартный порт, то необходимо переопредилить через group_vars.

- `user` & `group` - пользователь и группа для выставления прав доступа, по умолчанию `promtail`. По необходимости можно переопределить через group_vars. Для переменных будут созданы группа и пользователь, который включен в данную группу.

